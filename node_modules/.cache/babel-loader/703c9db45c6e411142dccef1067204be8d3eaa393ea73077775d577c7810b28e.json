{"ast":null,"code":"import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport { login } from './loginAPI';\nconst initialState = {\n  username: '',\n  password: '',\n  status: 'idle',\n  token: '',\n  logged: false\n};\nexport const loginAsync = createAsyncThunk('login/login', async credentials => {\n  const response = await login(credentials);\n  return response.data;\n});\nexport const loginSlice = createSlice({\n  name: 'login',\n  initialState,\n  reducers: {\n    increment: state => {}\n  },\n  extraReducers: builder => {\n    builder.addCase(loginAsync.fulfilled, (state, action) => {\n      state.token = action.payload.access;\n      state.logged = true;\n      state.status = 'loading';\n      sessionStorage.setItem('token', JSON.stringify(state.token));\n    }).addCase(loginAsync.rejected, (state, action) => {\n      // Assuming you have an API call rejection for expired token scenario\n      if (action.error.message === 'Token expired') {\n        state.token = ''; // Clear the expired token\n        state.logged = false; // Set logged to false\n        state.status = 'idle';\n        sessionStorage.removeItem('token'); // Remove the token from sessionStorage\n      }\n    });\n  }\n});\nexport const {\n  increment\n} = loginSlice.actions;\nexport const selectstatus = state => state.login.status;\nexport const selectLogged = state => state.login.logged;\nexport const selectToken = state => state.login.token;\nexport default loginSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","login","initialState","username","password","status","token","logged","loginAsync","credentials","response","data","loginSlice","name","reducers","increment","state","extraReducers","builder","addCase","fulfilled","action","payload","access","sessionStorage","setItem","JSON","stringify","rejected","error","message","removeItem","actions","selectstatus","selectLogged","selectToken","reducer"],"sources":["/Users/gilyasur/Documents/My Projects/dashBoard /Front/my-app/src/features/login/loginSlice.ts"],"sourcesContent":["import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport { RootState } from '../../app/store';\nimport { login } from './loginAPI';\n\n\nexport interface loginState {\n  username: string;\n  password:string\n  status: 'idle' | 'loading' | 'failed';\n  token:string\n  logged:boolean\n}\n\nconst initialState: loginState = {\n    username: '',\n    password: '',\n    status: 'idle',\n    token: '',\n    logged: false\n};\n\nexport const loginAsync = createAsyncThunk(\n  'login/login',\n  async (credentials: { username: string; password: string }) => {\n    const response = await login(credentials);\n    return response.data;\n  }\n);\n\nexport const loginSlice = createSlice({\n  name: 'login',\n  initialState,\n  reducers: {\n    increment: (state) => {\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(loginAsync.fulfilled, (state,action) => {\n        state.token=action.payload.access\n        state.logged=true\n        state.status = 'loading';\n        sessionStorage.setItem('token', JSON.stringify(state.token));\n    })\n    .addCase(loginAsync.rejected, (state, action) => {\n        // Assuming you have an API call rejection for expired token scenario\n        if (action.error.message === 'Token expired') {\n          state.token = ''; // Clear the expired token\n          state.logged = false; // Set logged to false\n          state.status = 'idle';\n          sessionStorage.removeItem('token'); // Remove the token from sessionStorage\n        }\n      });\n  },\n});\n\nexport const { increment } = loginSlice.actions;\nexport const selectstatus = (state: RootState) => state.login.status;\nexport const selectLogged = (state: RootState) => state.login.logged;\nexport const selectToken = (state: RootState) => state.login.token;\nexport default loginSlice.reducer;"],"mappings":"AAAA,SAASA,gBAAgB,EAAEC,WAAW,QAAQ,kBAAkB;AAEhE,SAASC,KAAK,QAAQ,YAAY;AAWlC,MAAMC,YAAwB,GAAG;EAC7BC,QAAQ,EAAE,EAAE;EACZC,QAAQ,EAAE,EAAE;EACZC,MAAM,EAAE,MAAM;EACdC,KAAK,EAAE,EAAE;EACTC,MAAM,EAAE;AACZ,CAAC;AAED,OAAO,MAAMC,UAAU,GAAGT,gBAAgB,CACxC,aAAa,EACb,MAAOU,WAAmD,IAAK;EAC7D,MAAMC,QAAQ,GAAG,MAAMT,KAAK,CAACQ,WAAW,CAAC;EACzC,OAAOC,QAAQ,CAACC,IAAI;AACtB,CACF,CAAC;AAED,OAAO,MAAMC,UAAU,GAAGZ,WAAW,CAAC;EACpCa,IAAI,EAAE,OAAO;EACbX,YAAY;EACZY,QAAQ,EAAE;IACRC,SAAS,EAAGC,KAAK,IAAK,CACtB;EACF,CAAC;EACDC,aAAa,EAAGC,OAAO,IAAK;IAC1BA,OAAO,CACJC,OAAO,CAACX,UAAU,CAACY,SAAS,EAAE,CAACJ,KAAK,EAACK,MAAM,KAAK;MAC/CL,KAAK,CAACV,KAAK,GAACe,MAAM,CAACC,OAAO,CAACC,MAAM;MACjCP,KAAK,CAACT,MAAM,GAAC,IAAI;MACjBS,KAAK,CAACX,MAAM,GAAG,SAAS;MACxBmB,cAAc,CAACC,OAAO,CAAC,OAAO,EAAEC,IAAI,CAACC,SAAS,CAACX,KAAK,CAACV,KAAK,CAAC,CAAC;IAChE,CAAC,CAAC,CACDa,OAAO,CAACX,UAAU,CAACoB,QAAQ,EAAE,CAACZ,KAAK,EAAEK,MAAM,KAAK;MAC7C;MACA,IAAIA,MAAM,CAACQ,KAAK,CAACC,OAAO,KAAK,eAAe,EAAE;QAC5Cd,KAAK,CAACV,KAAK,GAAG,EAAE,CAAC,CAAC;QAClBU,KAAK,CAACT,MAAM,GAAG,KAAK,CAAC,CAAC;QACtBS,KAAK,CAACX,MAAM,GAAG,MAAM;QACrBmB,cAAc,CAACO,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC;MACtC;IACF,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEhB;AAAU,CAAC,GAAGH,UAAU,CAACoB,OAAO;AAC/C,OAAO,MAAMC,YAAY,GAAIjB,KAAgB,IAAKA,KAAK,CAACf,KAAK,CAACI,MAAM;AACpE,OAAO,MAAM6B,YAAY,GAAIlB,KAAgB,IAAKA,KAAK,CAACf,KAAK,CAACM,MAAM;AACpE,OAAO,MAAM4B,WAAW,GAAInB,KAAgB,IAAKA,KAAK,CAACf,KAAK,CAACK,KAAK;AAClE,eAAeM,UAAU,CAACwB,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}